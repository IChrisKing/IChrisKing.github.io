<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>IChrisKing</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="IChrisKing">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="IChrisKing">
<meta property="og:locale" content="zh-Hant-TW">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="IChrisKing">
  
    <link rel="alternate" href="/atom.xml" title="IChrisKing" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">IChrisKing</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">#IMNOTCHRISLEE</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-oneday_BroadcastReceiver" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/22/oneday_BroadcastReceiver/" class="article-date">
  <time datetime="2016-09-21T23:43:52.000Z" itemprop="datePublished">2016-09-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>►<a class="article-category-link" href="/categories/Android/Android-everyday/">Android_everyday</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/22/oneday_BroadcastReceiver/">BroadcastReceiver</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://www.jianshu.com/p/df7af437e766" target="_blank" rel="external">用广播来更新UI界面好吗？</a></p>
<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>Android四大组件之一。</p>
<ol>
<li>广播接收器是一个专注于接收广播通知信息，并做出对应处理的组件。很多广播是源自于系统代码的──比如，通知时区改变、电池电量低、拍摄了一张照片或者用户改变了语言选项。应用程序也可以进行广播──比如说，通知其它应用程序一些数据下载完成并处于可用状态。</li>
<li>应用程序可以拥有任意数量的广播接收器以对所有它感兴趣的通知信息予以响应。所有的接收器均继承自BroadcastReceiver基类。</li>
<li>广播接收器没有用户界面。然而，它们可以启动一个activity来响应它们收到的信息，或者用NotificationManager来通知用户。通知可以用很多种方式来吸引用户的注意力──闪动背灯、震动、播放声音等等。一般来说是在状态栏上放一个持久的图标，用户可以打开它并获取消息。</li>
</ol>
<p>Android中的广播事件有两种，一种就是系统广播事件，比如：ACTION_BOOT_COMPLETED（系统启动完成后触发），ACTION_TIME_CHANGED（系统时间改变时触发），ACTION_BATTERY_LOW（电量低时触发）等等。另外一种是我们自定义的广播事件。</p>
<h2 id="源码位置"><a href="#源码位置" class="headerlink" title="源码位置"></a>源码位置</h2><p>frameworks/base/core/java/android/content/BroadcastReceiver.java</p>
<p>BroadcastReceiver是一个抽象类，继承它的子类，需要实现它的抽象方法：<code>public abstract void onReceive(Context context, Intent intent);</code></p>
<h2 id="注册广播"><a href="#注册广播" class="headerlink" title="注册广播"></a>注册广播</h2><h3 id="两种方法"><a href="#两种方法" class="headerlink" title="两种方法"></a>两种方法</h3><ul>
<li>静态注册</li>
</ul>
<ol>
<li><p>创建一个类继承BroadcastReceiver</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">public class MyReceiver extends BroadcastReceiver&#123;</div><div class="line">    private static final String MY_ACTION = &quot;com.testBroadcastReceiver.myaction&quot;;</div><div class="line">    @Override</div><div class="line">    public void onReceive(Context context, Intent intent) &#123;</div><div class="line">        String action = intent.getAction();</div><div class="line">        if(action.equal(MY_ACTION)) &#123;</div><div class="line">            Toast.makeText(context, &quot;静态:&quot;+action, 1000).show();</div><div class="line">        &#125;    </div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>到AndroidManifest.xml 添加receive标签</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;receiver android:name=&quot;MyReceiver&quot;&gt;  </div><div class="line">    &lt;intent-filter&gt;  </div><div class="line">        &lt;action  </div><div class="line">            android:name=&quot;com.testBroadcastReceiver.myaction&quot;/&gt;  </div><div class="line">    &lt;/intent-filter&gt;  </div><div class="line">&lt;/receiver&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li>动态注册<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">IntentFilter intentFilter  = new IntentFilter();  </div><div class="line">intentFilter .addAction(MY_ACTION); //指定action </div><div class="line">registerReceiver(myReceiver, intentFilter);  //注册监听</div><div class="line">unregisterReceiver(myReceiver); //取消监听</div></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>一般在onStart中注册，onStop中取消unregisterReceiver</strong></p>
<h2 id="发送广播"><a href="#发送广播" class="headerlink" title="发送广播"></a>发送广播</h2><p>发送广播消息，把要发送的信息和用于过滤的信息(如Action、Category)装入一个Intent对象，然后通过调用 Context.sendBroadcast()、sendOrderBroadcast()或sendStickyBroadcast()方法，把 Intent对象以广播方式发送出去。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Intent intent = new Intent(MY_ACTION);</div><div class="line">intent.putExtra(&quot;Name&quot;, &quot;abc&quot;);</div><div class="line">intent.putExtra(&quot;Msg&quot;, &quot;hello&quot;);</div><div class="line">sendBroadcast(intent);//传递过去</div></pre></td></tr></table></figure>
<h2 id="广播分类"><a href="#广播分类" class="headerlink" title="广播分类"></a>广播分类</h2><h3 id="Normal-broadcasts（普通广播）"><a href="#Normal-broadcasts（普通广播）" class="headerlink" title="Normal broadcasts（普通广播）"></a>Normal broadcasts（普通广播）</h3><p>Normal broadcasts是完全异步的可以同一时间被所有的接收者接收到。消息的传递效率比较高。但缺点是接收者不能将接收的消息的处理信息传递给下一个接收者也不能停止消息的传播。</p>
<h3 id="Ordered-broadcasts（有序广播）"><a href="#Ordered-broadcasts（有序广播）" class="headerlink" title="Ordered broadcasts（有序广播）"></a>Ordered broadcasts（有序广播）</h3><p>Ordered broadcasts的接收者按照一定的优先级进行消息的接收。如：A,B,C的优先级依次降低，那么消息先传递给A，在传递给B，最后传递给C。优先级别声明在中，取值为[-1000,1000]数值越大优先级别越高。优先级也可通过filter.setPriority(10)方式设置。 另外Ordered broadcasts的接收者可以通过abortBroadcast()的方式取消广播的传播，也可以通过setResultData和setResultExtras方法将处理的结果存入到Broadcast中，传递给下一个接收者。然后，下一个接收者通过getResultData()和getResultExtras(true)接收高优先级的接收者存入的数据。</p>
<h3 id="StickyBroadcast-（异步广播）"><a href="#StickyBroadcast-（异步广播）" class="headerlink" title="StickyBroadcast （异步广播）"></a>StickyBroadcast （异步广播）</h3><p>当处理完之后的Intent ，依然存在，这时候registerReceiver(BroadcastReceiver, IntentFilter) 还能收到他的值，直到你把它去掉 , 不能将处理结果传给下一个接收者 , 无法终止广播。</p>
<p>在发送广播时Reciever还没有被注册，但它注册后还是可以收到在它之前发送的那条广播</p>
<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><p>Receiver的生命周期很短，当它的onReceive方法执行完成后，它的生命周期就结束了。这时BroadcastReceiver已经不处于active状态，被系统杀掉的概率极高，也就是说如果你在onReceive去开线程进行异步操作或者打开Dialog都有可能在没达到你要的结果时进程就被系统杀掉。因为这个进程可能只有这个Receiver这个组件在运行，当Receiver也执行完后就是一个empty进程，是最容易被系统杀掉的。替代的方案是用Notificaiton或者Service（这种情况当然不能用bindService，因为bindService启动的service会在启动者被销毁后跟着被销毁）。</p>
<h2 id="题目解答"><a href="#题目解答" class="headerlink" title="题目解答"></a>题目解答</h2><p>如果界面并不需要频繁更新，那么可以使用广播。但如果时频繁的刷新界面，则不适合使用广播。因为广播的发送和接收是有一定的延迟的，它的传输是通过Binder进程间通信机制来实现的，系统需要为广播的传递做一些进程间通信的准备。</p>
<p>ActivityManagerService有一个专门的消息队列来接收发送出来的广播，sendBroadcast执行完后就立即返回，但这时发送来的广播只是被放入到队列，并不一定马上被处理。当处理到当前广播时，又会把这个广播分发给注册的广播接收分发器ReceiverDispatcher，ReceiverDispatcher最后又把广播交给接Receiver所在的线程的消息队列去处理（就是你熟悉的UI线程的Message Queue）。</p>
<p>整个过程从发送–ActivityManagerService–ReceiverDispatcher进行了两次Binder进程间通信，最后还要交到UI的消息队列，如果基中有一个消息的处理阻塞了UI，当然也会延迟你的onReceive的执行。</p>
<h2 id="LocalBroadcastManager"><a href="#LocalBroadcastManager" class="headerlink" title="LocalBroadcastManager"></a>LocalBroadcastManager</h2><h3 id="简介-1"><a href="#简介-1" class="headerlink" title="简介"></a>简介</h3><p>LocalBroadcastManager是Android Support包提供了一个工具，是用来在同一个应用内的不同组件间发送Broadcast的。</p>
<p>使用LocalBroadcastManager有如下好处：</p>
<ul>
<li>发送的广播只会在自己App内传播，不会泄露给其他App，确保隐私数据不会泄露</li>
<li>其他App也无法向你的App发送该广播，不用担心其他App会来搞破坏</li>
<li>比系统全局广播更加高效</li>
</ul>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ol>
<li><p>通过getInstance获取实例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">LocalBroadcastManager lbm = LocalBroadcastManager.getInstance(this);</div></pre></td></tr></table></figure>
</li>
<li><p>通过函数 registerReceiver来注册监听器</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">lbm.registerReceiver(new BroadcastReceiver() &#123;  </div><div class="line">        @Override  </div><div class="line">        public void onReceive(Context context, Intent intent) &#123;  </div><div class="line">        // TODO Handle the received local broadcast  </div><div class="line">        &#125;  </div><div class="line">    &#125;, new IntentFilter(LOCAL_ACTION));</div></pre></td></tr></table></figure>
</li>
<li><p>通过 sendBroadcast 函数来发送广播</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">lbm.sendBroadcast(new Intent(LOCAL_ACTION));</div></pre></td></tr></table></figure>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/22/oneday_BroadcastReceiver/" data-id="cje6pjw1x003uweyxl8pq67lp" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android-everyday/">Android_everyday</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-oneday_service" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/21/oneday_service/" class="article-date">
  <time datetime="2016-09-21T13:50:19.000Z" itemprop="datePublished">2016-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>►<a class="article-category-link" href="/categories/Android/Android-everyday/">Android_everyday</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/21/oneday_service/">Android中的Service</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://www.jianshu.com/p/7a7db9f8692d" target="_blank" rel="external">知道Service吗，它有几种启动方式？</a></p>
<p>题目：</p>
<h2 id="service生命周期"><a href="#service生命周期" class="headerlink" title="service生命周期"></a>service生命周期</h2><p>两张生命周期的图</p>
<p><img src="/assets/img/android_service/life_cycle_1.png" alt="image"></p>
<p><img src="/assets/img/android_service/life_cycle_2.png" alt="image"></p>
<p>当我们第一次使用startservice启动Service时，先后调用了onCreate(),onStart()这两个方法，当停止Service时，则执行onDestroy()方法，这里需要注意的是，如果Service已经启动了，当我们再次启动Service时，不会在执行onCreate()方法，而是直接执行onStart()方法</p>
<h2 id="源码位置"><a href="#源码位置" class="headerlink" title="源码位置"></a>源码位置</h2><p>frameworks/base/core/java/android/app/Service.java</p>
<h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><ul>
<li>Service是一个抽象类，它有一个抽象方法<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">public abstract IBinder onBind(Intent intent);</div></pre></td></tr></table></figure>
</li>
</ul>
<p>所有继承自Service的类，都要实现这个抽象方法。</p>
<ul>
<li>继承service的子类在重写service的方法中，除了一个onStart()方法之外，还有一个onStartCommand()方法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">public void onStart(Intent intent, int startId) &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">public int onStartCommand(Intent intent, int flags, int startId) &#123;</div><div class="line">        onStart(intent, startId);</div><div class="line">        return mStartCompatibility ? START_STICKY_COMPATIBILITY : START_STICKY;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<p>可以看到，onStartCommand内部调用了onStart方法，并且返回了一个int类型的值。</p>
<p>查看源码中的注释，可以看到这样的返回值有四个：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * Constant to return from &#123;@link #onStartCommand&#125;: compatibility</div><div class="line"> * version of &#123;@link #START_STICKY&#125; that does not guarantee that</div><div class="line"> * &#123;@link #onStartCommand&#125; will be called again after being killed.</div><div class="line"> */</div><div class="line"> public static final int START_STICKY_COMPATIBILITY = 0;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Constant to return from &#123;@link #onStartCommand&#125;: if this service&apos;s</div><div class="line"> * process is killed while it is started (after returning from</div><div class="line"> * &#123;@link #onStartCommand&#125;), then leave it in the started state but</div><div class="line"> * don&apos;t retain this delivered intent.  Later the system will try to</div><div class="line"> * re-create the service.  Because it is in the started state, it will</div><div class="line"> * guarantee to call &#123;@link #onStartCommand&#125; after creating the new</div><div class="line"> * service instance; if there are not any pending start commands to be</div><div class="line"> * delivered to the service, it will be called with a null intent</div><div class="line"> * object, so you must take care to check for this.</div><div class="line"> * </div><div class="line"> * &lt;p&gt;This mode makes sense for things that will be explicitly started</div><div class="line"> * and stopped to run for arbitrary periods of time, such as a service</div><div class="line"> * performing background music playback.</div><div class="line"> */</div><div class="line">public static final int START_STICKY = 1;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Constant to return from &#123;@link #onStartCommand&#125;: if this service&apos;s</div><div class="line"> * process is killed while it is started (after returning from</div><div class="line"> * &#123;@link #onStartCommand&#125;), and there are no new start intents to</div><div class="line"> * deliver to it, then take the service out of the started state and</div><div class="line"> * don&apos;t recreate until a future explicit call to</div><div class="line"> * &#123;@link Context#startService Context.startService(Intent)&#125;.  The</div><div class="line"> * service will not receive a &#123;@link #onStartCommand(Intent, int, int)&#125;</div><div class="line"> * call with a null Intent because it will not be re-started if there</div><div class="line"> * are no pending Intents to deliver.</div><div class="line"> * </div><div class="line"> * &lt;p&gt;This mode makes sense for things that want to do some work as a</div><div class="line"> * result of being started, but can be stopped when under memory pressure</div><div class="line"> * and will explicit start themselves again later to do more work.  An</div><div class="line"> * example of such a service would be one that polls for data from</div><div class="line"> * a server: it could schedule an alarm to poll every N minutes by having</div><div class="line"> * the alarm start its service.  When its &#123;@link #onStartCommand&#125; is</div><div class="line"> * called from the alarm, it schedules a new alarm for N minutes later,</div><div class="line"> * and spawns a thread to do its networking.  If its process is killed</div><div class="line"> * while doing that check, the service will not be restarted until the</div><div class="line"> * alarm goes off.</div><div class="line"> */</div><div class="line">public static final int START_NOT_STICKY = 2;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Constant to return from &#123;@link #onStartCommand&#125;: if this service&apos;s</div><div class="line"> * process is killed while it is started (after returning from</div><div class="line"> * &#123;@link #onStartCommand&#125;), then it will be scheduled for a restart</div><div class="line"> * and the last delivered Intent re-delivered to it again via</div><div class="line"> * &#123;@link #onStartCommand&#125;.  This Intent will remain scheduled for</div><div class="line"> * redelivery until the service calls &#123;@link #stopSelf(int)&#125; with the</div><div class="line"> * start ID provided to &#123;@link #onStartCommand&#125;.  The</div><div class="line"> * service will not receive a &#123;@link #onStartCommand(Intent, int, int)&#125;</div><div class="line"> * call with a null Intent because it will will only be re-started if</div><div class="line"> * it is not finished processing all Intents sent to it (and any such</div><div class="line"> * pending events will be delivered at the point of restart).</div><div class="line"> */</div><div class="line">public static final int START_REDELIVER_INTENT = 3;</div></pre></td></tr></table></figure>
<p>START_STICKY：如果service进程被kill掉，保留service的状态为开始状态，但不保留递送的intent对象。随后系统会尝试重新创建service，由于服务状态为开始状态，所以创建服务后一定会调用onStartCommand(Intent,int,int)方法。如果在此期间没有任何启动命令被传递到service，那么参数Intent将为null。</p>
<p>START_NOT_STICKY：“非粘性的”。使用这个返回值时，如果在执行完onStartCommand后，服务被异常kill掉，系统将会把它置为started状态，系统不会自动重启该服务，直到startService(Intent intent)方法再次被调用;。</p>
<p>START_REDELIVER_INTENT：重传Intent。使用这个返回值时，如果在执行完onStartCommand后，服务被异常kill掉，系统会自动重启该服务，并将Intent的值传入。</p>
<p>START_STICKY_COMPATIBILITY：START_STICKY的兼容版本，但不保证服务被kill后一定能重启。</p>
<h2 id="启动service"><a href="#启动service" class="headerlink" title="启动service"></a>启动service</h2><h3 id="两种方法"><a href="#两种方法" class="headerlink" title="两种方法"></a>两种方法</h3><ul>
<li>方法一：Context.startService()</li>
</ul>
<p>在同一个应用任何地方调用 startService() 方法就能启动 Service 了，然后系统会回调 Service 类的 onCreate() 以及 onStart() 方法。这样启动的 Service 会一直运行在后台，直到 Context.stopService() 或者 selfStop() 方法被调用。另外如果一个 Service 已经被启动，其他代码再试图调用 startService() 方法，是不会执行 onCreate() 的，但会重新执行一次 onStart() 。</p>
<ul>
<li>方法二：Context.bindService()</li>
</ul>
<p>bindService() 方法是把这个 Service 和调用 Service 的客户类绑定起来，如果调用这个客户类被销毁，Service 也会被销毁。用这个方法的一个好处是，bindService() 方法执行后 Service 会回调onBind() 方法，你可以从这里返回一个实现了 IBind 接口的类，在客户端操作这个类就能和这个服务通信了，比如得到 Service 运行的状态或其他操作。当发现所有绑定都进行了unBind时才会销毁Service。</p>
<h3 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h3><p>再看一遍生命周期的图</p>
<p><img src="/assets/img/android_service/life_cycle_2.png" alt="image"></p>
<p>两种启动方法的主要差异就在Active Lifetime期间。</p>
<p>启动时，startService调用onStartCommand,bindService调用onBind</p>
<p>停止时，startService直到service调用selfStop或者有组件调用stopService()才停止,bindService则在发现所有绑定都进行了unBind时才会销毁Service</p>
<h2 id="service的子类IntentService"><a href="#service的子类IntentService" class="headerlink" title="service的子类IntentService"></a>service的子类IntentService</h2><h3 id="IntentService简介"><a href="#IntentService简介" class="headerlink" title="IntentService简介"></a>IntentService简介</h3><p>IntentService是Service类的子类，用来处理异步请求。客户端可以通过startService(Intent)方法传递请求给IntentService。</p>
<p>与Service相比，IntentService有以下不同：</p>
<ol>
<li><p>startService(Intent)方法启动，而非bindServie</p>
</li>
<li><p>IntentServie默认创建新的线程运行. 而Service是缺少这个特质的,因为Service和调用者( 比如某个Activity )是运行在同一个进程中,会直接和调用竞争有限的资源,所以Service不适合用于处理耗时耗资源的任务,否则极易阻塞主线程导致ANR错误.</p>
</li>
<li><p>IntentService自动实现多线程, 会新建工作线程专门处理任务, 同时使用了队列来管理请求启动IntentService的各个Intent. 比如当有3个intent都请求该IntentService,那么IntentService会按照队列顺序依次去新建线程,处理任务,保证在同一时间内只有一个intent在调用该intentService.</p>
</li>
<li><p>当调用完毕后intentService会自动停止自身,并处理下一次的调用，直至最后处理完所有请求。所以如果使用intentService, 用户并不需要主动的使用stopService() 或者在intentService中使用stopSelf()来停止.</p>
</li>
<li><p>继承IntentService必须实现onHandleIntent()方法, 将耗时的任务放在这个方法内即可. </p>
</li>
</ol>
<h3 id="源码位置-1"><a href="#源码位置-1" class="headerlink" title="源码位置"></a>源码位置</h3><p>frameworks/base/core/java/android/app/IntentService.java</p>
<h3 id="源码分析-1"><a href="#源码分析-1" class="headerlink" title="源码分析"></a>源码分析</h3><p>分析源码，来查看上面说到的不同点</p>
<ol>
<li><p>实现了onStart和onStartCommand，但只在onBind中返回了null</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public void onStart(Intent intent, int startId) &#123;</div><div class="line">    Message msg = mServiceHandler.obtainMessage();</div><div class="line">    msg.arg1 = startId;</div><div class="line">    msg.obj = intent;</div><div class="line">    mServiceHandler.sendMessage(msg);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> * You should not override this method for your IntentService. Instead,</div><div class="line"> * override &#123;@link #onHandleIntent&#125;, which the system calls when the IntentService</div><div class="line"> * receives a start request.</div><div class="line"> * @see android.app.Service#onStartCommand</div><div class="line"> */</div><div class="line">@Override</div><div class="line">public int onStartCommand(Intent intent, int flags, int startId) &#123;</div><div class="line">    onStart(intent, startId);</div><div class="line">    return mRedelivery ? START_REDELIVER_INTENT : START_NOT_STICKY;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> * Unless you provide binding for your service, you don&apos;t need to implement this</div><div class="line"> * method, because the default implementation returns null. </div><div class="line"> * @see android.app.Service#onBind</div><div class="line"> */</div><div class="line">@Override</div><div class="line">public IBinder onBind(Intent intent) &#123;</div><div class="line">    return null;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>查看onCreate函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">@Override</div><div class="line">public void onCreate() &#123;</div><div class="line">    // TODO: It would be nice to have an option to hold a partial wakelock</div><div class="line">    // during processing, and to have a static startService(Context, Intent)</div><div class="line">    // method that would launch the service &amp; hand off a wakelock.</div><div class="line"></div><div class="line">    super.onCreate();</div><div class="line">    HandlerThread thread = new HandlerThread(&quot;IntentService[&quot; + mName + &quot;]&quot;);</div><div class="line">    thread.start();</div><div class="line"></div><div class="line">    mServiceLooper = thread.getLooper();</div><div class="line">    mServiceHandler = new ServiceHandler(mServiceLooper);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>可以看到，在onCreate中，new了一个HandlerThread来处理后续的工作。IntentService在处理事务时，还是采用的Handler方式，创建一个名叫ServiceHandler的内部Handler，并把它直接绑定到HandlerThread所对应的子线程。 </p>
<ol>
<li><p>IntentService内部实现了一个ServiceHandler类来依次处理任务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">private final class ServiceHandler extends Handler &#123;</div><div class="line">        public ServiceHandler(Looper looper) &#123;</div><div class="line">            super(looper);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        @Override</div><div class="line">        public void handleMessage(Message msg) &#123;</div><div class="line">            onHandleIntent((Intent)msg.obj);</div><div class="line">            stopSelf(msg.arg1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
</li>
<li><p>在任务处理完成后，调用stopSelf(msg.arg1);来结束自己，这就不再需要用户主动调用stopService,或者在intentService中使用stopSelf()来停止.</p>
</li>
<li><p>ServiceHandler把处理一个intent所对应的事务都封装到叫做onHandleIntent的虚函数；因此我们直接实现虚函数onHandleIntent，再在里面根据Intent的不同进行不同的事务处理就可以了。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@WorkerThread</div><div class="line">protected abstract void onHandleIntent(Intent intent);</div></pre></td></tr></table></figure>
</li>
<li><p>此外，IntentService的构造函数一定是参数为空的构造函数，然后再在其中调用super(“name”)这种形式的构造函数。<br>因为Service的实例化是系统来完成的，而且系统是用参数为空的构造函数来实例化Service的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public IntentService(String name) &#123;</div><div class="line">    super();</div><div class="line">    mName = name;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<p>举个栗子：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public MyIntentService() &#123;</div><div class="line"> super(&quot;com.lenovo.robin.test.MyIntentService&quot;);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="使用IntentService的例子"><a href="#使用IntentService的例子" class="headerlink" title="使用IntentService的例子"></a>使用IntentService的例子</h3><p>使用IntentService需要两个步骤：</p>
<ol>
<li>写构造函数</li>
<li>实现虚函数onHandleIntent，并在里面根据Intent<br>的不同进行不同的事务处理</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">public class MyIntentService extends IntentService &#123;</div><div class="line">final static String TAG=&quot;robin&quot;;</div><div class="line"> public MyIntentService() &#123;</div><div class="line">  super(&quot;com.lenovo.robin.test.MyIntentService&quot;);</div><div class="line">  Log.i(TAG,this+&quot; is constructed&quot;);</div><div class="line"> &#125;</div><div class="line"> @Override</div><div class="line"> protected void onHandleIntent(Intent arg0) &#123;</div><div class="line">  Log.i(TAG,&quot;begin onHandleIntent() in &quot;+this);</div><div class="line">  try &#123;</div><div class="line">   Thread.sleep(10*1000);</div><div class="line">  &#125; catch (InterruptedException e) &#123;</div><div class="line">     e.printStackTrace();</div><div class="line">  &#125;</div><div class="line">  Log.i(TAG,&quot;end onHandleIntent() in &quot;+this);</div><div class="line"> &#125;</div><div class="line"> public void onDestroy()</div><div class="line"> &#123;</div><div class="line">  super.onDestroy();</div><div class="line">  Log.i(TAG,this+&quot; is destroy&quot;);</div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/21/oneday_service/" data-id="cje6pjw220046weyxh8ggntmd" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android-everyday/">Android_everyday</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-sunjdk" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/21/sunjdk/" class="article-date">
  <time datetime="2016-09-21T12:44:20.000Z" itemprop="datePublished">2016-09-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/21/sunjdk/">如何安装sunjdk，并用它替代openjdk</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h2><p>为了使用Android Studio，需要将openjdk换成sunjdk</p>
<h2 id="过程"><a href="#过程" class="headerlink" title="过程"></a>过程</h2><ol>
<li>oracle上下载最新的sunjdk<br><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="external">JavaPlatform(JDK)</a><br>下载了8u102版本的Linux x64位的jdk-8u101-linux-x64.rpm<br>下载完成后<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">rpm -ivh jdk-8u101-linux-x64.rpm</div></pre></td></tr></table></figure>
</li>
</ol>
<p>点击解压出的.deb，安装程序</p>
<ol>
<li>配置环境变量<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sudo vim /etc/profile</div></pre></td></tr></table></figure>
</li>
</ol>
<p>增加<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">JAVAHOME=/usr/java/jdk1.8.0_102</div><div class="line">export PATH=$PATH:/usr/java/jdk1.8.0_102/bin/</div><div class="line">export CLASSPATH=$CLASSPATH:/usr/java/jdk1.8.0_102/lib</div></pre></td></tr></table></figure></p>
<ol>
<li>更改默认jdk</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sudo update-alternatives --install /usr/bin/java java /usr/java/jdk1.8.0_102/bin/java 400</div><div class="line"></div><div class="line">sudo update-alternatives --install /usr/bin/javac javac /usr/java/jdk1.8.0_102/bin/javac 400</div><div class="line"></div><div class="line">sudo update-alternatives --config java</div></pre></td></tr></table></figure>
<p>显示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">有 2 个候选项可用于替换 java (提供 /usr/bin/java)。</div><div class="line"></div><div class="line">  选择       路径                                          优先级  状态</div><div class="line">------------------------------------------------------------</div><div class="line">  0            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      自动模式</div><div class="line">* 1            /usr/java/jdk1.8.0_102/bin/java                  400       手动模式</div><div class="line">  2            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      手动模式</div><div class="line"></div><div class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：</div></pre></td></tr></table></figure></p>
<p>选择1<br>查看修改效果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -version</div></pre></td></tr></table></figure></p>
<p>显示<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">java version &quot;1.8.0_102&quot;</div><div class="line">Java(TM) SE Runtime Environment (build 1.8.0_102-b14)</div><div class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.102-b14, mixed mode)</div></pre></td></tr></table></figure></p>
<h2 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">java -version</div></pre></td></tr></table></figure>
<p>时，报错<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Error occurred during initialization of VM</div><div class="line"></div><div class="line">java/lang/NoClassDefFoundError: java/lang/Object</div></pre></td></tr></table></figure></p>
<p>检查PATH和CLASSPATH都设置没问题，查看安装目时居然发现lib目录下没有tools.jar但有tools.pack;jre/lib下没有rt.jar，但有rt.pack</p>
<p>解决方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">cd /usr/java/jdk1.8.0_102/lib</div><div class="line">sudo ../bin/unpack200 tools.pack tools.jar</div><div class="line"></div><div class="line">cd /usr/java/jdk1.8.0_102/jre/lib</div><div class="line">sudo ../bin/unpack200 rt.pack rt.jar</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/21/sunjdk/" data-id="cje6pjw30006pweyxk3zofn5o" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tool/">tool</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/填坑/">填坑</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-mvp_in_android" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/19/mvp_in_android/" class="article-date">
  <time datetime="2016-09-19T13:53:34.000Z" itemprop="datePublished">2016-09-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/19/mvp_in_android/">MVP in Android</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MVP的模式讲解</p>
<p><a href="http://www.jianshu.com/p/7567ed0d1853" target="_blank" rel="external">【译】Android开发中的MVP架构</a></p>
<p>一个简单的MVP示例，实现登录功能</p>
<p><a href="http://blog.csdn.net/lmj623565791/article/details/46596109" target="_blank" rel="external">浅谈 MVP in Android</a></p>
<p>一个稍复杂的MVP示例，实现新闻客户端</p>
<p><a href="http://www.cnblogs.com/liuling/archive/2015/12/23/mvp-pattern-android.html" target="_blank" rel="external">MVP模式在Android项目中的使用</a></p>
<p><a href="http://blog.csdn.net/guxiao1201/article/details/40151457" target="_blank" rel="external">Android开发MVP模式实践</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/19/mvp_in_android/" data-id="cje6pjw1p0039weyx8evkjtcq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java_synchronized" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/19/java_synchronized/" class="article-date">
  <time datetime="2016-09-19T01:26:34.000Z" itemprop="datePublished">2016-09-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>►<a class="article-category-link" href="/categories/Java/Android开发工程师/">Android开发工程师</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/19/java_synchronized/">Java并发</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Thread与Runable"><a href="#Thread与Runable" class="headerlink" title="Thread与Runable"></a>Thread与Runable</h2><p>继承Thread类和实现Runable接口都可以实现多线程。两种方式都要通过重写run()方法来定义线程的行为，推荐使用后者，因为Java中的继承是单继承，一个类有一个父类，如果继承了Thread类就无法再继承其他类了，显然使用Runnable接口更为灵活。</p>
<p>实现Runnable接口相比继承Thread类有如下优势：</p>
<ol>
<li>可以避免由于Java的单继承特性而带来的局限</li>
<li>增强程序的健壮性，代码能够被多个程序共享，代码与数据是独立的</li>
<li>适合多个相同程序代码的线程区处理同一资源的情况</li>
</ol>
<p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/Thread%E5%92%8CRunnable%E5%AE%9E%E7%8E%B0%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%8C%BA%E5%88%AB.md" target="_blank" rel="external">Thread和Runnable实现多线程的区别</a></p>
<h2 id="Callable接口"><a href="#Callable接口" class="headerlink" title="Callable接口"></a>Callable接口</h2><p>Java 5以后创建线程还有第三种方式：实现Callable接口，该接口中的call方法可以在线程执行结束时产生一个返回值，代码如下所示：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">class MyTask implements Callable&lt;Integer&gt; &#123;  </div><div class="line">    private int upperBounds;  </div><div class="line"></div><div class="line">    public MyTask(int upperBounds) &#123;  </div><div class="line">        this.upperBounds = upperBounds;  </div><div class="line">    &#125;  </div><div class="line"></div><div class="line">    @Override  </div><div class="line">    public Integer call() throws Exception &#123;  </div><div class="line">        int sum = 0;   </div><div class="line">        for(int i = 1; i &lt;= upperBounds; i++) &#123;  </div><div class="line">            sum += i;  </div><div class="line">        &#125;  </div><div class="line">        return sum;  </div><div class="line">    &#125;  </div><div class="line"></div><div class="line">&#125;  </div><div class="line"></div><div class="line">public class Test &#123;  </div><div class="line"></div><div class="line">    public static void main(String[] args) throws Exception &#123;  </div><div class="line">        List&lt;Future&lt;Integer&gt;&gt; list = new ArrayList&lt;&gt;();  </div><div class="line">        ExecutorService service = Executors.newFixedThreadPool(10);  </div><div class="line">        for(int i = 0; i &lt; 10; i++) &#123;  </div><div class="line">            list.add(service.submit(new MyTask((int) (Math.random() * 100))));  </div><div class="line">        &#125;  </div><div class="line"></div><div class="line">        int sum = 0;  </div><div class="line">        for(Future&lt;Integer&gt; future : list) &#123;  </div><div class="line">            while(!future.isDone()) ;  </div><div class="line">            sum += future.get();  </div><div class="line">        &#125;  </div><div class="line"></div><div class="line">        System.out.println(sum);  </div><div class="line">    &#125;  </div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="生产者消费者的例子"><a href="#生产者消费者的例子" class="headerlink" title="生产者消费者的例子"></a>生产者消费者的例子</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">public class ProducerConsumerTest &#123;</div><div class="line"></div><div class="line">    public static void main(String[] args) &#123;</div><div class="line">        PublicResource resource = new PublicResource();</div><div class="line">        new Thread(new ProducerThread(resource)).start();</div><div class="line">        new Thread(new ConsumerThread(resource)).start();</div><div class="line">        new Thread(new ProducerThread(resource)).start();</div><div class="line">        new Thread(new ConsumerThread(resource)).start();</div><div class="line">        new Thread(new ProducerThread(resource)).start();</div><div class="line">        new Thread(new ConsumerThread(resource)).start();</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">package 生产者消费者;</div><div class="line">/**</div><div class="line"> * 生产者线程，负责生产公共资源</div><div class="line"> * @author dream</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class ProducerThread implements Runnable&#123;</div><div class="line"></div><div class="line">    private PublicResource resource;</div><div class="line"></div><div class="line"></div><div class="line">    public ProducerThread(PublicResource resource) &#123;</div><div class="line">        this.resource = resource;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        while (true) &#123;</div><div class="line">            try &#123;</div><div class="line">                Thread.sleep((long) (Math.random() * 1000));</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            resource.increase();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line">package 生产者消费者;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 消费者线程，负责消费公共资源</div><div class="line"> * @author dream</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class ConsumerThread implements Runnable&#123;</div><div class="line"></div><div class="line">    private PublicResource resource;</div><div class="line"></div><div class="line"></div><div class="line">    public ConsumerThread(PublicResource resource) &#123;</div><div class="line">        this.resource = resource;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    @Override</div><div class="line">    public void run() &#123;</div><div class="line">        while (true) &#123;</div><div class="line">            try &#123;</div><div class="line">                Thread.sleep((long) (Math.random() * 1000));</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                // TODO Auto-generated catch block</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            resource.decrease();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div><div class="line">package 生产者消费者;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 公共资源类</div><div class="line"> * @author dream</div><div class="line"> *</div><div class="line"> */</div><div class="line">public class PublicResource &#123;</div><div class="line"></div><div class="line">    private int number = 0;</div><div class="line">    private int size = 10;</div><div class="line"></div><div class="line">    /**</div><div class="line">     * 增加公共资源</div><div class="line">     */</div><div class="line">    public synchronized void increase()</div><div class="line">    &#123;</div><div class="line">        while (number &gt;= size) &#123;</div><div class="line">            try &#123;</div><div class="line">                wait();</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                // TODO Auto-generated catch block</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        number++;</div><div class="line">        System.out.println(&quot;生产了1个，总共有&quot; + number);</div><div class="line">        notifyAll();</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    /**</div><div class="line">     * 减少公共资源</div><div class="line">     */</div><div class="line">    public synchronized void decrease()</div><div class="line">    &#123;</div><div class="line">        while (number &lt;= 0) &#123;</div><div class="line">            try &#123;</div><div class="line">                wait();</div><div class="line">            &#125; catch (InterruptedException e) &#123;</div><div class="line">                // TODO Auto-generated catch block</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        number--;</div><div class="line">        System.out.println(&quot;消费了1个，总共有&quot; + number);</div><div class="line">        notifyAll();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="线程中断"><a href="#线程中断" class="headerlink" title="线程中断"></a>线程中断</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/%E7%BA%BF%E7%A8%8B%E4%B8%AD%E6%96%AD.md" target="_blank" rel="external">线程中断</a></p>
<h2 id="线程同步"><a href="#线程同步" class="headerlink" title="线程同步"></a>线程同步</h2><h3 id="synchronized"><a href="#synchronized" class="headerlink" title="synchronized"></a>synchronized</h3><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/Synchronized.md" target="_blank" rel="external">synchronized</a></p>
<p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%8E%AF%E5%A2%83%E4%B8%AD%E5%AE%89%E5%85%A8%E4%BD%BF%E7%94%A8%E9%9B%86%E5%90%88API.md" target="_blank" rel="external">多线程环境中安全使用集合API</a></p>
<h3 id="锁"><a href="#锁" class="headerlink" title="锁"></a>锁</h3><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/%E6%AD%BB%E9%94%81.md" target="_blank" rel="external">死锁</a></p>
<p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaConcurrent/%E5%8F%AF%E9%87%8D%E5%85%A5%E5%86%85%E7%BD%AE%E9%94%81.md" target="_blank" rel="external">可重入内置锁</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/19/java_synchronized/" data-id="cje6pjw1m0031weyxqaxdx74y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java_list_hashmap" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/18/java_list_hashmap/" class="article-date">
  <time datetime="2016-09-18T12:57:31.000Z" itemprop="datePublished">2016-09-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>►<a class="article-category-link" href="/categories/Java/Android开发工程师/">Android开发工程师</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/18/java_list_hashmap/">Java集合框架</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Java集合框架概述"><a href="#Java集合框架概述" class="headerlink" title="Java集合框架概述"></a>Java集合框架概述</h2><p><a href="http://doc.okbase.net/DavidIsOK/archive/94766.html" target="_blank" rel="external">Java的集合框架最全详解（图）</a></p>
<p><a href="http://www.cnblogs.com/xiohao/p/4309462.html" target="_blank" rel="external">java集合框架的讲解</a></p>
<h2 id="ArrayList"><a href="#ArrayList" class="headerlink" title="ArrayList"></a>ArrayList</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/ArrayList%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">ArrayList简介</a></p>
<p><a href="http://zhangshixi.iteye.com/blog/674856" target="_blank" rel="external">深入Java集合学习系列：ArrayList的实现原理</a></p>
<p>动态数组，默认长度10，扩容时默认 原长度*3/2+1，不够的话，直接增加到需要的长度。扩容代价大，应尽量避免，所以，ArrayList适合预知要保存的元素数量时使用。</p>
<p>非线程安全</p>
<p>查找效率高，插入删除效率低</p>
<p>它允许所有元素，包括null</p>
<h2 id="LinkedList"><a href="#LinkedList" class="headerlink" title="LinkedList"></a>LinkedList</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/LinkedList%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">LinkedList简介</a></p>
<p>双向循环链表，可以当栈，队列，双端队列。<br>因为是链表，所以扩容无压力，无参的构造函数，会返回一个表头。</p>
<p>非线程安全</p>
<p>查找效率低，插入删除效率高</p>
<p>允许元素为null</p>
<h2 id="Vector"><a href="#Vector" class="headerlink" title="Vector"></a>Vector</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/Vector%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">Vector简介</a></p>
<p>与ArrayList相似</p>
<p>默认容量10</p>
<p>线程安全</p>
<p>允许元素为null</p>
<h2 id="HashMap"><a href="#HashMap" class="headerlink" title="HashMap"></a>HashMap</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/HashMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">HashMap简介</a></p>
<p><a href="http://zhangshixi.iteye.com/blog/672697" target="_blank" rel="external">深入Java集合学习系列：HashMap的实现原理</a></p>
<p>HashMap是基于哈希表的Map接口的非同步实现。此实现提供所有可选的映射操作，并允许使用null值和null键。此类不保证映射的顺序，特别是它不保证该顺序恒久不变。</p>
<p>默认的初始容量（容量为HashMap中槽的数目）是16，且实际容量必须是2的整数次幂</p>
<p>非线程安全</p>
<p>初始容量是2的n次方，负载因子（loadFactor）默认0.75</p>
<p>HashMap中key和value都允许为null</p>
<p>key为null的键值对永远都放在以table[0]为头结点的链表中，当然不一定是存放在头结点table[0]中</p>
<h2 id="HashTable"><a href="#HashTable" class="headerlink" title="HashTable"></a>HashTable</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/HashTable%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">Hashtable简介</a></p>
<p>线程安全</p>
<p>默认容量为11</p>
<p>key和value都不允许为null</p>
<h2 id="LinkedHashMap"><a href="#LinkedHashMap" class="headerlink" title="LinkedHashMap"></a>LinkedHashMap</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/LinkedHashMap%E6%BA%90%E7%A0%81%E5%89%96%E6%9E%90.md" target="_blank" rel="external">LinkedHashMap简介</a></p>
<p>HashMap的子类，与HashMap有着同样的存储结构，但它加入了一个双向链表的头结点，将所有put到LinkedHashmap的节点一一串成了一个双向循环链表，因此它保留了节点插入的顺序，可以使节点的输出顺序与输入顺序相同。</p>
<p>非线程安全</p>
<p>允许key和value为null</p>
<p>accessOrder标志位，当它false时，表示双向链表中的元素按照Entry插入LinkedHashMap到中的先后顺序排序，即每次put到LinkedHashMap中的Entry都放在双向链表的尾部，这样遍历双向链表时，Entry的输出顺序便和插入的顺序一致，这也是默认的双向链表的存储顺序；当它为true时，表示双向链表中的元素按照访问的先后顺序排列，可以看到，虽然Entry插入链表的顺序依然是按照其put到LinkedHashMap中的顺序，但put和get方法均有调用recordAccess方法（put方法在key相同，覆盖原有的Entry的情况下调用recordAccess方法），该方法判断accessOrder是否为true，如果是，则将当前访问的Entry（put进来的Entry或get出来的Entry）移到双向链表的尾部（key不相同时，put新Entry时，会调用addEntry，它会调用creatEntry，该方法同样将新插入的元素放入到双向链表的尾部，既符合插入的先后顺序，又符合访问的先后顺序，因为这时该Entry也被访问了），否则，什么也不做。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/18/java_list_hashmap/" data-id="cje6pjw1k002wweyxfyhtgrae" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-java_basic" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/09/java_basic/" class="article-date">
  <time datetime="2016-09-08T23:16:31.000Z" itemprop="datePublished">2016-09-09</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Java/">Java</a>►<a class="article-category-link" href="/categories/Java/Android开发工程师/">Android开发工程师</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/09/java_basic/">Java基础知识</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="八种基本数据类型的大小，以及他们的封装类"><a href="#八种基本数据类型的大小，以及他们的封装类" class="headerlink" title="八种基本数据类型的大小，以及他们的封装类"></a>八种基本数据类型的大小，以及他们的封装类</h2><p>八种基本数据类型，int ,double ,long ,float, short,byte,character,boolean</p>
<p>对应的封装类型是：Integer ,Double ,Long ,Float, Short,Byte,Character,Boolean</p>
<h2 id="equals与-的区别"><a href="#equals与-的区别" class="headerlink" title="equals与==的区别"></a>equals与==的区别</h2><p><a href="http://www.importnew.com/6804.html" target="_blank" rel="external">http://www.importnew.com/6804.html</a></p>
<h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><p><a href="http://www.cnblogs.com/yumo/p/4908315.html" target="_blank" rel="external">Object有哪些公用方法</a></p>
<h2 id="java的四种引用"><a href="#java的四种引用" class="headerlink" title="java的四种引用"></a>java的四种引用</h2><p><a href="http://blog.csdn.net/sbvfhp/article/details/43371487" target="_blank" rel="external">JAVA四种引用方式</a></p>
<p><a href="http://www.cnblogs.com/yumo/p/4908416.html" target="_blank" rel="external">Java的四种引用，强弱软虚，用到的场景</a></p>
<h2 id="hashcode"><a href="#hashcode" class="headerlink" title="hashcode"></a>hashcode</h2><p><a href="http://c610367182.iteye.com/blog/1930676" target="_blank" rel="external">Hashcode的作用</a></p>
<h2 id="String-StringBuffer-StringBuilder"><a href="#String-StringBuffer-StringBuilder" class="headerlink" title="String StringBuffer StringBuilder"></a>String StringBuffer StringBuilder</h2><p><a href="http://blog.csdn.net/rmn190/article/details/1492013" target="_blank" rel="external">String,StringBuffer与StringBuilder的区别</a></p>
<h2 id="Exception-Error"><a href="#Exception-Error" class="headerlink" title="Exception Error"></a>Exception Error</h2><p><a href="http://www.cnblogs.com/yumo/p/4909617.html" target="_blank" rel="external">Excption与Error包结构。OOM你遇到过哪些情况，SOF你遇到过哪些情况</a></p>
<h2 id="Java面向对象的三个特征与含义。"><a href="#Java面向对象的三个特征与含义。" class="headerlink" title="Java面向对象的三个特征与含义。"></a>Java面向对象的三个特征与含义。</h2><ul>
<li><p>继承：继承是从已有类得到继承信息创建新类的过程。提供继承信息的类被称为父类（超类、基类）；得到继承信息的类被称为子类（派生类）。继承让变化中的软件系统有了一定的延续性，同时继承也是封装程序中可变因素的重要手段。</p>
</li>
<li><p>封装：通常认为封装是把数据和操作数据的方法绑定起来，对数据的访问只能通过已定义的接口。面向对象的本质就是将现实世界描绘成一系列完全自治、封闭的对象。我们在类中编写的方法就是对实现细节的一种封装；我们编写一个类就是对数据和数据操作的封装。可以说，封装就是隐藏一切可隐藏的东西，只向外界提供最简单的编程接口（可以想想普通洗衣机和全自动洗衣机的差别，明显全自动洗衣机封装更好因此操作起来更简单；我们现在使用的智能手机也是封装得足够好的，因为几个按键就搞定了所有的事情）。</p>
</li>
<li><p>多态：多态性是指允许不同子类型的对象对同一消息作出不同的响应。简单的说就是用同样的对象引用调用同样的方法但是做了不同的事情。多态性分为编译时的多态性和运行时的多态性。如果将对象的方法视为对象向外界提供的服务，那么运行时的多态性可以解释为：当A系统访问B系统提供的服务时，B系统有多种提供服务的方式，但一切对A系统来说都是透明的（就像电动剃须刀是A系统，它的供电系统是B系统，B系统可以使用电池供电或者用交流电，甚至还有可能是太阳能，A系统只会通过B类对象调用供电的方法，但并不知道供电系统的底层实现是什么，究竟通过何种方式获得了动力）。方法重载（overload）实现的是编译时的多态性（也称为前绑定），而方法重写（override）实现的是运行时的多态性（也称为后绑定）。运行时的多态是面向对象最精髓的东西，要实现多态需要做两件事：1. 方法重写（子类继承父类并重写父类中已有的或抽象的方法）；2. 对象造型（用父类型引用引用子类型对象，这样同样的引用调用同样的方法就会根据子类对象的不同而表现出不同的行为）。</p>
</li>
</ul>
<h2 id="Override和Overload的含义与区别"><a href="#Override和Overload的含义与区别" class="headerlink" title="Override和Overload的含义与区别"></a>Override和Overload的含义与区别</h2><p>Overload：顾名思义，就是Over(重新)——load（加载），所以中文名称是重载。它可以表现类的多态性，可以是函数里面可以有相同的函数名但是参数名、类型不能相同；或者说可以改变参数、类型但是函数名字依然不变。</p>
<p>Override：就是ride(重写)的意思，在子类继承父类的时候子类中可以定义某方法与其父类有相同的名称和参数，当子类在调用这一函数时自动调用子类的方法，而父类相当于被覆盖（重写）了。</p>
<p>方法的重写Overriding和重载Overloading是Java多态性的不同表现。重写Overriding是父类与子类之间多态性的一种表现，重载Overloading是一个类中多态性的一种表现。如果在子类中定义某方法与其父类有相同的名称和参数，我们说该方法被重写 (Overriding)。子类的对象使用这个方法时，将调用子类中的定义，对它而言，父类中的定义如同被“屏蔽”了。如果在一个类中定义了多个同名的方法，它们或有不同的参数个数或有不同的参数类型，则称为方法的重载(Overloading)。Overloaded的方法是可以改变返回值的类型。</p>
<h2 id="Interface与abstract类的区别"><a href="#Interface与abstract类的区别" class="headerlink" title="Interface与abstract类的区别"></a>Interface与abstract类的区别</h2><p><a href="http://blog.csdn.net/b271737818/article/details/3950245" target="_blank" rel="external">abstract class和interface的区别</a></p>
<h2 id="Static-class-与non-static-class的区别"><a href="#Static-class-与non-static-class的区别" class="headerlink" title="Static class 与non static class的区别"></a>Static class 与non static class的区别</h2><p><a href="http://blog.csdn.net/luanxj/article/details/1451932" target="_blank" rel="external">static与non-static的区别</a></p>
<h2 id="反射机制"><a href="#反射机制" class="headerlink" title="反射机制"></a>反射机制</h2><p><a href="http://blog.csdn.net/yongjian1092/article/details/7364451" target="_blank" rel="external"> Java反射机制详解</a></p>
<p><a href="http://shensy.iteye.com/blog/1698197" target="_blank" rel="external">Java动态代理详解</a></p>
<h2 id="String类内部实现"><a href="#String类内部实现" class="headerlink" title="String类内部实现"></a>String类内部实现</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part2/JavaSE/String%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.md" target="_blank" rel="external">String源码分析</a></p>
<p><a href="http://blog.csdn.net/zhangjg_blog/article/details/18319521" target="_blank" rel="external"> Java中的String为什么是不可变的？ – String源码分析</a></p>
<h2 id="try-catch-块，try里有return，finally也有return，如何执行"><a href="#try-catch-块，try里有return，finally也有return，如何执行" class="headerlink" title="try catch 块，try里有return，finally也有return，如何执行"></a>try catch 块，try里有return，finally也有return，如何执行</h2><p><a href="http://qing0991.blog.51cto.com/1640542/1387200" target="_blank" rel="external">关于Java中try-catch-finally-return的执行顺序</a></p>
<h2 id="java泛型"><a href="#java泛型" class="headerlink" title="java泛型"></a>java泛型</h2><p><a href="http://www.cnblogs.com/lwbqqyumidi/p/3837629.html" target="_blank" rel="external">Java总结篇系列：Java泛型</a></p>
<h2 id="解析XML的几种方式的原理与特点：DOM、SAX、PULL。"><a href="#解析XML的几种方式的原理与特点：DOM、SAX、PULL。" class="headerlink" title="解析XML的几种方式的原理与特点：DOM、SAX、PULL。"></a>解析XML的几种方式的原理与特点：DOM、SAX、PULL。</h2><p><a href="http://www.cnblogs.com/HaroldTihan/p/4316397.html" target="_blank" rel="external">Java sax、dom、pull解析xml</a></p>
<h2 id="java和c-的简单对比"><a href="#java和c-的简单对比" class="headerlink" title="java和c++的简单对比"></a>java和c++的简单对比</h2><p><a href="http://developer.51cto.com/art/201106/270422.htm" target="_blank" rel="external">详细介绍JAVA和C++区别
</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/09/java_basic/" data-id="cje6pjw1h002oweyx66pj77q5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-pattern-design" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/09/08/pattern-design/" class="article-date">
  <time datetime="2016-09-08T07:57:03.000Z" itemprop="datePublished">2016-09-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/设计模式/">设计模式</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/09/08/pattern-design/">设计模式概述</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="http://www.jianshu.com/p/7023407b2512" target="_blank" rel="external">武林秘籍之设计模式迷你手册</a></p>
<p><a href="http://www.uml.org.cn/chanpin/intro/WebHelp/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E8%BF%B7%E4%BD%A0%E6%89%8B%E5%86%8C.htm" target="_blank" rel="external">迷你手册</a></p>
<p><a href="http://www.cnblogs.com/java-my-life/default.html?page=3" target="_blank" rel="external">java与模式</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/09/08/pattern-design/" data-id="cje6pjw2a004uweyxukxm3uwz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Binder" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/31/Binder/" class="article-date">
  <time datetime="2016-08-31T13:33:11.000Z" itemprop="datePublished">2016-08-31</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>►<a class="article-category-link" href="/categories/Android/Android开发工程师/">Android开发工程师</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/31/Binder/">Binder</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Binder"><a href="#Binder" class="headerlink" title="Binder"></a>Binder</h2><h3 id="框架分析"><a href="#框架分析" class="headerlink" title="框架分析"></a>框架分析</h3><p>Binder是Android进程间通信的方式之一。采用Server，Client通信方式。</p>
<p><img src="/assets/img/Binder/binder.png" alt="image"><br>Binder的架构，分为四块：</p>
<ol>
<li>BinderDriver 位于内核空间，源码在/kernel/drivers/staging/android/目录下，Binder驱动提供设备文件/dev/binder与用户空间交互</li>
<li>Service Manager 位于用户空间，源码在/frameworks/native/cmds/servicemanager/目录下。Service Manager是一个守护进程，用来管理Server，并向Client提供查询Server接口的功能。</li>
<li>Server</li>
<li>Client</li>
</ol>
<h3 id="Service-Manager成为Binder守护进程"><a href="#Service-Manager成为Binder守护进程" class="headerlink" title="Service Manager成为Binder守护进程"></a>Service Manager成为Binder守护进程</h3><ul>
<li><p>Service Manager是整个Binder机制的守护进程，负责管理系统中的所有Server，并向Client提供查询Server远程接口的功能。</p>
</li>
<li><p>Service Manager与Server和Client通信，也属于进程间通信，也采用的Binder机制。所以说，Service Manager在充当Binder机制的守护进程的同时，也是一个Server。他是一个特殊的Server。</p>
</li>
</ul>
<p>Service Manager的入口位于/frameworks/native/cmds/servicemanager/service_manager.c中的main函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">int main(int argc, char **argv)</div><div class="line">&#123;</div><div class="line">    struct binder_state *bs;</div><div class="line"></div><div class="line">//第一步</div><div class="line">    bs = binder_open(128*1024);</div><div class="line">    if (!bs) &#123;</div><div class="line">        ALOGE(&quot;failed to open binder driver\n&quot;);</div><div class="line">        return -1;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">//第二步</div><div class="line">    if (binder_become_context_manager(bs)) &#123;</div><div class="line">        ALOGE(&quot;cannot become context manager (%s)\n&quot;, strerror(errno));</div><div class="line">        return -1;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">//一些selinux相关操作</div><div class="line">    selinux_enabled = is_selinux_enabled();</div><div class="line">    sehandle = selinux_android_service_context_handle();</div><div class="line">    selinux_status_open(true);</div><div class="line"></div><div class="line">    if (selinux_enabled &gt; 0) &#123;</div><div class="line">        if (sehandle == NULL) &#123;</div><div class="line">            ALOGE(&quot;SELinux: Failed to acquire sehandle. Aborting.\n&quot;);</div><div class="line">            abort();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        if (getcon(&amp;service_manager_context) != 0) &#123;</div><div class="line">            ALOGE(&quot;SELinux: Failed to acquire service_manager context. Aborting.\n&quot;);</div><div class="line">            abort();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    union selinux_callback cb;</div><div class="line">    cb.func_audit = audit_callback;</div><div class="line">    selinux_set_callback(SELINUX_CB_AUDIT, cb);</div><div class="line">    cb.func_log = selinux_log_callback;</div><div class="line">    selinux_set_callback(SELINUX_CB_LOG, cb);</div><div class="line"></div><div class="line">//第三步</div><div class="line">    binder_loop(bs, svcmgr_handler);</div><div class="line"></div><div class="line">    return 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>main函数主要使用三个函数，完成三个步骤：</p>
<h4 id="1-打开Binder设备文件"><a href="#1-打开Binder设备文件" class="headerlink" title="1.打开Binder设备文件"></a>1.打开Binder设备文件</h4><p><code>bs = binder_open(128*1024);</code>返回一个binder_state类型的bs<br>binder_open的实现在/frameworks/native/cmds/servicemanager/binder.c中。查看这个函数之前，首先来看一下结构体binder_state，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">struct binder_state</div><div class="line">&#123;</div><div class="line">    int fd;</div><div class="line">    void *mapped;</div><div class="line">    size_t mapsize;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>
<p>fd是文件描述符，即表示打开的/dev/binder设备文件描述符；</p>
<p>mapped是把设备文件/dev/binder映射到进程空间的起始地址；</p>
<p>mapsize是上述内存映射空间的大小。</p>
<p>查看函数的binder_open实现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">struct binder_state *binder_open(size_t mapsize)</div><div class="line">&#123;</div><div class="line">    struct binder_state *bs;</div><div class="line">    struct binder_version vers;</div><div class="line"></div><div class="line">    bs = malloc(sizeof(*bs));</div><div class="line">    if (!bs) &#123;</div><div class="line">        errno = ENOMEM;</div><div class="line">        return NULL;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    bs-&gt;fd = open(&quot;/dev/binder&quot;, O_RDWR);</div><div class="line">    if (bs-&gt;fd &lt; 0) &#123;</div><div class="line">        fprintf(stderr,&quot;binder: cannot open device (%s)\n&quot;,</div><div class="line">                strerror(errno));</div><div class="line">        goto fail_open;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    if ((ioctl(bs-&gt;fd, BINDER_VERSION, &amp;vers) == -1) ||</div><div class="line">        (vers.protocol_version != BINDER_CURRENT_PROTOCOL_VERSION)) &#123;</div><div class="line">        fprintf(stderr,</div><div class="line">                &quot;binder: kernel driver version (%d) differs from user space version (%d)\n&quot;,</div><div class="line">                vers.protocol_version, BINDER_CURRENT_PROTOCOL_VERSION);</div><div class="line">        goto fail_open;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    bs-&gt;mapsize = mapsize;</div><div class="line">    bs-&gt;mapped = mmap(NULL, mapsize, PROT_READ, MAP_PRIVATE, bs-&gt;fd, 0);</div><div class="line">    if (bs-&gt;mapped == MAP_FAILED) &#123;</div><div class="line">        fprintf(stderr,&quot;binder: cannot map device (%s)\n&quot;,</div><div class="line">                strerror(errno));</div><div class="line">        goto fail_map;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    return bs;</div><div class="line"></div><div class="line">fail_map:</div><div class="line">    close(bs-&gt;fd);</div><div class="line">fail_open:</div><div class="line">    free(bs);</div><div class="line">    return NULL;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这个函数的内容，围绕着给binder_state *bs赋值展开，根据上面binder_state结构体的内容，这个函数的主要操作包括：<br>1.<code>bs-&gt;fd = open(&quot;/dev/binder&quot;, O_RDWR);</code></p>
<p>这就调用到了kernel层的Binder驱动了，这里暂时不对驱动层的代码作详细分析，仅指出原理和源码位置。具体分析可以参考<a href="http://blog.csdn.net/luoshengyang/article/details/6621566" target="_blank" rel="external">参考文档</a></p>
<p>源码位置在/kernel/drivers/staging/android/binder.c<br>中的static int binder_open(struct inode <em>nodp, struct file </em>filp)函数。</p>
<p>这个函数的主要作用是创建一个struct binder_proc数据结构来保存打开设备文件/dev/binder的进程的上下文信息，并且将这个进程上下文信息保存在打开文件结构struct file的私有数据成员变量private_data中，这样，在执行其它文件操作时，就通过打开文件结构struct file来取回这个进程上下文信息了。这个进程上下文信息同时还会保存在一个全局哈希表binder_procs中，驱动程序内部使用。</p>
<p>2.<code>bs-&gt;mapsize = mapsize;</code><br>设置内存映射空间的大小</p>
<p>3.<code>bs-&gt;mapped = mmap(NULL, mapsize, PROT_READ, MAP_PRIVATE, bs-&gt;fd, 0);</code></p>
<p>对打开的设备文件进行内存映射操作mmap，这调用到了/kernel/drivers/staging/android/binder.c<br>中的static int binder_mmap(struct file <em>filp, struct vm_area_struct </em>vma)函数</p>
<p>这个函数将一个物理地址，同时映射到进程虚拟地址空间和内核虚拟地址空间。这就是Binder进程间通信机制的精髓所在了，同一个物理页面，一方映射到进程虚拟地址空间，一方面映射到内核虚拟地址空间，这样，进程和内核之间就可以减少一次内存拷贝了，提到了进程间通信效率。举个例子如，Client要将一块内存数据传递给Server，一般的做法是，Client将这块数据从它的进程空间拷贝到内核空间中，然后内核再将这个数据从内核空间拷贝到Server的进程空间，这样，Server就可以访问这个数据了。但是在这种方法中，执行了两次内存拷贝操作，而采用我们上面提到的方法，只需要把Client进程空间的数据拷贝一次到内核空间，然后Server与内核共享这个数据就可以了，整个过程只需要执行一次内存拷贝，提高了效率。</p>
<h4 id="2-向Binder驱动声明自己是Binder上下文管理者，即Binder守护进程"><a href="#2-向Binder驱动声明自己是Binder上下文管理者，即Binder守护进程" class="headerlink" title="2.向Binder驱动声明自己是Binder上下文管理者，即Binder守护进程"></a>2.向Binder驱动声明自己是Binder上下文管理者，即Binder守护进程</h4><p><code>binder_become_context_manager(bs)</code></p>
<p>查看/frameworks/native/cmds/servicemanager/binder.c，发现这个函数的实现非常简单<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">int binder_become_context_manager(struct binder_state *bs)</div><div class="line">&#123;</div><div class="line">    return ioctl(bs-&gt;fd, BINDER_SET_CONTEXT_MGR, 0);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>这里通过调用ioctl文件操作函数来通知Binder驱动程序自己是守护进程，命令号是BINDER_SET_CONTEXT_MGR，没有参数。再次到驱动程序中来查看实现过程，调用到了/kernel/drivers/staging/android/binder.c<br>中的<code>static long binder_ioctl(struct file *filp, unsigned int cmd, unsigned long arg)</code>函数，只需查看switch中的BINDER_SET_CONTEXT_MG代码段即可。<br>这段代码的实现类似一种先到先得的机制，将第一个调用到此的线程设置为Binder机制的守护进程，并为他创建Binder实体。</p>
<h4 id="3-进入一个无穷循环，充当Server的角色，等待Client请求"><a href="#3-进入一个无穷循环，充当Server的角色，等待Client请求" class="headerlink" title="3. 进入一个无穷循环，充当Server的角色，等待Client请求"></a>3. 进入一个无穷循环，充当Server的角色，等待Client请求</h4><p><code>binder_loop(bs, svcmgr_handler);</code><br>该函数定义在/frameworks/native/cmds/servicemanager/binder.c中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">void binder_loop(struct binder_state *bs, binder_handler func)</div><div class="line">&#123;</div><div class="line">    int res;</div><div class="line">    struct binder_write_read bwr;</div><div class="line">    uint32_t readbuf[32];</div><div class="line"></div><div class="line">    bwr.write_size = 0;</div><div class="line">    bwr.write_consumed = 0;</div><div class="line">    bwr.write_buffer = 0;</div><div class="line"></div><div class="line">    readbuf[0] = BC_ENTER_LOOPER;</div><div class="line">    binder_write(bs, readbuf, sizeof(uint32_t));</div><div class="line"></div><div class="line">    for (;;) &#123;</div><div class="line">        bwr.read_size = sizeof(readbuf);</div><div class="line">        bwr.read_consumed = 0;</div><div class="line">        bwr.read_buffer = (uintptr_t) readbuf;</div><div class="line"></div><div class="line">        res = ioctl(bs-&gt;fd, BINDER_WRITE_READ, &amp;bwr);</div><div class="line"></div><div class="line">        if (res &lt; 0) &#123;</div><div class="line">            ALOGE(&quot;binder_loop: ioctl failed (%s)\n&quot;, strerror(errno));</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        res = binder_parse(bs, 0, (uintptr_t) readbuf, bwr.read_consumed, func);</div><div class="line">        if (res == 0) &#123;</div><div class="line">            ALOGE(&quot;binder_loop: unexpected reply?!\n&quot;);</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">        if (res &lt; 0) &#123;</div><div class="line">            ALOGE(&quot;binder_loop: io error %d %s\n&quot;, res, strerror(errno));</div><div class="line">            break;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>首先是通过binder_write函数执行BC_ENTER_LOOPER命令告诉Binder驱动程序， Service Manager要进入循环了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">int binder_write(struct binder_state *bs, void *data, size_t len)</div><div class="line">&#123;</div><div class="line">    struct binder_write_read bwr;</div><div class="line">    int res;</div><div class="line"></div><div class="line">    bwr.write_size = len;</div><div class="line">    bwr.write_consumed = 0;</div><div class="line">    bwr.write_buffer = (uintptr_t) data;</div><div class="line">    bwr.read_size = 0;</div><div class="line">    bwr.read_consumed = 0;</div><div class="line">    bwr.read_buffer = 0;</div><div class="line">    res = ioctl(bs-&gt;fd, BINDER_WRITE_READ, &amp;bwr);</div><div class="line">    if (res &lt; 0) &#123;</div><div class="line">        fprintf(stderr,&quot;binder_write: ioctl failed (%s)\n&quot;,</div><div class="line">                strerror(errno));</div><div class="line">    &#125;</div><div class="line">    return res;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>熟悉的ioctl，又进入kernel层的驱动程序的，这次只看BINDER_WRITE_READ代码块</p>
<p>随后进入 for (;;)循环，再次调用了ioctl的BINDER_WRITE_READ代码块</p>
<h3 id="Server和Client获得Service-Manager接口"><a href="#Server和Client获得Service-Manager接口" class="headerlink" title="Server和Client获得Service Manager接口"></a>Server和Client获得Service Manager接口</h3><p>Service Manager在Binder机制中既充当守护进程的角色，同时它也充当着Server角色，然而它又与一般的Server不一样。对于普通的Server来说，Client如果想要获得Server的远程接口，那么必须通过Service Manager远程接口提供的getService接口来获得，这本身就是一个使用Binder机制来进行进程间通信的过程。而对于Service Manager这个Server来说，Client如果想要获得Service Manager远程接口，却不必通过进程间通信机制来获得，因为Service Manager远程接口是一个特殊的Binder引用，它的引用句柄一定是0。</p>
<p> 获取Service Manager远程接口的函数是defaultServiceManager，这个函数在frameworks/native/libs/binder/IServiceManager.cpp文件中：<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">sp&lt;IServiceManager&gt; defaultServiceManager()</div><div class="line">&#123;</div><div class="line">    if (gDefaultServiceManager != NULL) return gDefaultServiceManager;</div><div class="line">    </div><div class="line">    &#123;</div><div class="line">        AutoMutex _l(gDefaultServiceManagerLock);</div><div class="line">        while (gDefaultServiceManager == NULL) &#123;</div><div class="line">            gDefaultServiceManager = interface_cast&lt;IServiceManager&gt;(</div><div class="line">                ProcessState::self()-&gt;getContextObject(NULL));</div><div class="line">            if (gDefaultServiceManager == NULL)</div><div class="line">                sleep(1);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    return gDefaultServiceManager;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p> gDefaultServiceManagerLock和gDefaultServiceManager是全局变量，定义在frameworks/native/libs/binder/Static.cpp文件中：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Mutex gDefaultServiceManagerLock;</div><div class="line">sp&lt;IServiceManager&gt; gDefaultServiceManager;</div></pre></td></tr></table></figure></p>
<p>gDefaultServiceManager是单例模式，调用defaultServiceManager函数时，如果gDefaultServiceManager已经创建，则直接返回，否则通过<code>interface_cast&lt;IServiceManager&gt;(ProcessState::self()-&gt;getContextObject(NULL))</code>来创建一个，并保存在gDefaultServiceManager全局变量中。本质上是创建了一个BpServiceManager，包含了一个句柄值为0的Binder引用。<br>具体创建过程分析参照<br><a href="http://blog.csdn.net/luoshengyang/article/details/6627260" target="_blank" rel="external">http://blog.csdn.net/luoshengyang/article/details/6627260</a><br><a href="http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html" target="_blank" rel="external">http://www.cnblogs.com/innost/archive/2011/01/09/1931456.html</a></p>
<p>这两篇文章详细的分析了创建过程。</p>
<p>获取到这个Service Manager之后，Server可以调用IServiceManager::addService这个接口来和Binder驱动程序交互了，即调用BpServiceManager::addService 。而BpServiceManager::addService又会调用通过其基类BpRefBase的成员函数remote获得原先创建的BpBinder实例，接着调用BpBinder::transact成员函数。在BpBinder::transact函数中，又会调用IPCThreadState::transact成员函数，这里就是最终与Binder驱动程序交互的地方了。IPCThreadState有一个PorcessState类型的成中变量mProcess，而mProcess有一个成员变量mDriverFD，它是设备文件/dev/binder的打开文件描述符，因此，IPCThreadState就相当于间接在拥有了设备文件/dev/binder的打开文件描述符，于是，便可以与Binder驱动程序交互了。</p>
<p>Client获得Service Manager之后，调用IServiceManager::getService这个接口来和Binder驱动程序交互了。</p>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part1/Android/Binder%E6%9C%BA%E5%88%B6.md" target="_blank" rel="external">Binder机制</a></p>
<p><a href="http://blog.csdn.net/luoshengyang/article/details/6618363/" target="_blank" rel="external">Android进程间通信（IPC）机制Binder简要介绍和学习计划</a></p>
<p><a href="http://blog.csdn.net/luoshengyang/article/details/6621566" target="_blank" rel="external">浅谈Service Manager成为Android进程间通信（IPC）机制Binder守护进程之路</a></p>
<p><a href="http://blog.csdn.net/luoshengyang/article/details/6627260" target="_blank" rel="external">浅谈Android系统进程间通信（IPC）机制Binder中的Server和Client获得Service Manager接口之路</a></p>
<p><a href="http://blog.csdn.net/luoshengyang/article/details/6629298" target="_blank" rel="external"> Android系统进程间通信（IPC）机制Binder中的Server启动过程源代码分析</a></p>
<p><a href="http://blog.csdn.net/luoshengyang/article/details/6633311" target="_blank" rel="external">Android系统进程间通信（IPC）机制Binder中的Client获得Server远程接口过程源代码分析</a></p>
<h2 id="其他讲解Binder的文章"><a href="#其他讲解Binder的文章" class="headerlink" title="其他讲解Binder的文章"></a>其他讲解Binder的文章</h2><p><a href="http://www.open-open.com/lib/view/open1464181227898.html" target="_blank" rel="external">Binder牌胶水,在Android中无处不在</a></p>
<p><a href="http://www.open-open.com/lib/view/open1452649194089.html" target="_blank" rel="external">Binder学习指南</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/08/31/Binder/" data-id="cje6pjw0l000jweyx7e7g2g43" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Fragment" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2016/08/24/Fragment/" class="article-date">
  <time datetime="2016-08-24T14:09:33.000Z" itemprop="datePublished">2016-08-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Android/">Android</a>►<a class="article-category-link" href="/categories/Android/Android开发工程师/">Android开发工程师</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/08/24/Fragment/">Fragment</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><a href="https://github.com/GeniusVJR/LearningNotes/blob/master/Part1/Android/Fragment.md" target="_blank" rel="external">原文链接</a></p>
<h2 id="Fragment依附于Activity的生命状态"><a href="#Fragment依附于Activity的生命状态" class="headerlink" title="Fragment依附于Activity的生命状态"></a>Fragment依附于Activity的生命状态</h2><p><img src="/assets/img/Fragment/FragmentWithActivity.jpg" alt="image"></p>
<h2 id="Fragment生命周期方法含义"><a href="#Fragment生命周期方法含义" class="headerlink" title="Fragment生命周期方法含义"></a>Fragment生命周期方法含义</h2><ul>
<li>public void onAttach(Context context)<ul>
<li>onAttach方法会在Fragment于窗口关联后立刻调用。从该方法开始，就可以通过Fragment.getActivity方法获取与Fragment关联的窗口对象，但因为Fragment的控件未初始化，所以不能够操作控件。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onCreate(Bundle savedInstanceState)<ul>
<li>在调用完onAttach执行完之后立刻调用onCreate方法，可以在Bundle对象中获取一些在Activity中传过来的数据。通常会在该方法中读取保存的状态，获取或初始化一些数据。在该方法中不要进行耗时操作，不然窗口不会显示。</li>
</ul>
</li>
</ul>
<ul>
<li>public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState)<ul>
<li>该方法是Fragment很重要的一个生命周期方法，因为会在该方法中创建在Fragment显示的View，其中inflater是用来装载布局文件的，container是<fragment>标签的父标签对应对象，savedInstanceState参数可以获取Fragment保存的状态，如果未保存那么就为null。</fragment></li>
</ul>
</li>
</ul>
<ul>
<li>public void onViewCreated(View view,Bundle savedInstanceState)<ul>
<li>Android在创建完Fragment中的View对象之后，会立刻回调该方法。其种view参数就是onCreateView中返回的view，而bundle对象用于一般用途。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onActivityCreated(Bundle savedInstanceState)<ul>
<li>在Activity的onCreate方法执行完之后，Android系统会立刻调用该方法，表示窗口已经初始化完成，从这一个时候开始，就可以在Fragment中使用getActivity().findViewById(Id);来操控Activity中的view了。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onStart()<ul>
<li>当系统调用该方法的时候，fragment已经显示在ui上，但还不能进行互动，因为onResume方法还没执行完。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onResume()<ul>
<li>该方法为fragment从创建到显示Android系统调用的最后一个生命周期方法，调用完该方法时候，fragment就可以与用户互动了。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onPause()<ul>
<li>fragment由活跃状态变成非活跃状态执行的第一个回调方法，通常可以在这个方法中保存一些需要临时暂停的工作。如保存音乐播放进度，然后在onResume中恢复音乐播放进度。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onStop()<ul>
<li>当onStop返回的时候，fragment将从屏幕上消失。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onDestoryView()<ul>
<li>该方法的调用意味着在 onCreateView 中创建的视图都将被移除。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onDestroy()<ul>
<li>Android在Fragment不再使用时会调用该方法，要注意的是~这时Fragment还和Activity藕断丝连！并且可以获得Fragment对象，但无法对获得的Fragment进行任何操作。</li>
</ul>
</li>
</ul>
<ul>
<li>public void onDetach()<ul>
<li>为Fragment生命周期中的最后一个方法，当该方法执行完后，Fragment与Activity不再有关联</li>
</ul>
</li>
</ul>
<h2 id="Fragment与Activity传递参数"><a href="#Fragment与Activity传递参数" class="headerlink" title="Fragment与Activity传递参数"></a>Fragment与Activity传递参数</h2><p>Fragment.setArguments(Bundle args)</p>
<p>Fragment.getArguments()</p>
<h2 id="Fragment状态持久化"><a href="#Fragment状态持久化" class="headerlink" title="Fragment状态持久化"></a>Fragment状态持久化</h2><ul>
<li><p>方法一：</p>
<p>protected void onSaveInstanceState(Bundle outState)</p>
<p>protected void onRestoreInstanceState(Bundle savedInstanceState) </p>
</li>
<li><p>方法二：这个方法仅仅能够保存Fragment中的控件状态，比如说EditText中用户已经输入的文字，并且，空间必须设置id，否则无法保存控件状态</p>
<p>FragmentManager.putFragment(Bundle bundle, String key, Fragment fragment) </p>
<p>FragmentManager.getFragment(Bundle bundle, String key)</p>
<ul>
<li>方法三：保存变量<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">  /** Activity中的代码 **/</div><div class="line"> FragmentB fragmentB;</div><div class="line"></div><div class="line">@Override</div><div class="line">protected void onCreate(@Nullable Bundle savedInstanceState) &#123;</div><div class="line">    super.onCreate(savedInstanceState);</div><div class="line">    setContentView(R.layout.fragment_activity);</div><div class="line">    if( savedInstanceState != null )&#123;</div><div class="line">        fragmentB = (FragmentB) getSupportFragmentManager().getFragment(savedInstanceState,&quot;fragmentB&quot;);</div><div class="line">    &#125;</div><div class="line">    init();</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Override</div><div class="line">protected void onSaveInstanceState(Bundle outState) &#123;</div><div class="line">    if( fragmentB != null )&#123;</div><div class="line">        getSupportFragmentManager().putFragment(outState,&quot;fragmentB&quot;,fragmentB);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    super.onSaveInstanceState(outState);</div><div class="line">&#125;</div><div class="line"></div><div class="line">/** Fragment中保存变量的代码 **/</div><div class="line"></div><div class="line">@Nullable</div><div class="line">@Override</div><div class="line">public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) &#123;</div><div class="line">    AppLog.e(&quot;onCreateView&quot;);</div><div class="line">    if ( null != savedInstanceState )&#123;</div><div class="line">        String savedString = savedInstanceState.getString(&quot;string&quot;);</div><div class="line">        //得到保存下来的string</div><div class="line">    &#125;</div><div class="line">    View root = inflater.inflate(R.layout.fragment_a,null);</div><div class="line">    return root;</div><div class="line">&#125;</div><div class="line"></div><div class="line">@Override</div><div class="line">public void onSaveInstanceState(Bundle outState) &#123;</div><div class="line">    outState.putString(&quot;string&quot;,&quot;anAngryAnt&quot;);</div><div class="line">    super.onSaveInstanceState(outState);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="complete-activity-fragment-lifecycle"><a href="#complete-activity-fragment-lifecycle" class="headerlink" title="complete activity/fragment lifecycle"></a>complete activity/fragment lifecycle</h2><p> <img src="/assets/img/Fragment/complete_android_fragment_lifecycle.png" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2016/08/24/Fragment/" data-id="cje6pjw0k000hweyxt6ulnyfu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/4/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/6/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android-everyday/">Android_everyday</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Android/Android开发工程师/">Android开发工程师</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/AndroidRom/">AndroidRom</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Anrom/">Anrom</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Anrom/rom7-0/">rom7.0</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Java/Android开发工程师/">Android开发工程师</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/SEAndroid/">SEAndroid</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cjdns/">cjdns</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/cjdns/cjdns源码分析/">cjdns源码分析</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/cjdns-cjdns源码分析/">cjdns - cjdns源码分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/music/">music</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/net/">net</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/net/iptables/">iptables</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/树莓派/">树莓派</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/树莓派/配置/">配置</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/算法/">算法</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/算法/Java/">Java</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/">设计模式</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/设计模式/Java/">Java</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android-everyday/">Android_everyday</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android开发工程师/">Android开发工程师</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Anrom/">Anrom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-C/">C/C++</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SEAndroid/">SEAndroid</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SELinux/">SELinux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cjdns/">cjdns</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cjdns源码分析/">cjdns源码分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iptables/">iptables</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/raspberry配置/">raspberry配置</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rom/">rom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shadowsocks-vps/">shadowsocks/vps</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/填坑/">填坑</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/排序算法/">排序算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据结构/">数据结构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/查找算法/">查找算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/树莓派raspberry/">树莓派raspberry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Android/" style="font-size: 20px;">Android</a> <a href="/tags/Android-everyday/" style="font-size: 16.67px;">Android_everyday</a> <a href="/tags/Android开发工程师/" style="font-size: 15.56px;">Android开发工程师</a> <a href="/tags/Anrom/" style="font-size: 14.44px;">Anrom</a> <a href="/tags/C-C/" style="font-size: 14.44px;">C/C++</a> <a href="/tags/Java/" style="font-size: 18.89px;">Java</a> <a href="/tags/Linux/" style="font-size: 13.33px;">Linux</a> <a href="/tags/SEAndroid/" style="font-size: 10px;">SEAndroid</a> <a href="/tags/SELinux/" style="font-size: 10px;">SELinux</a> <a href="/tags/cjdns/" style="font-size: 14.44px;">cjdns</a> <a href="/tags/cjdns源码分析/" style="font-size: 14.44px;">cjdns源码分析</a> <a href="/tags/git/" style="font-size: 11.11px;">git</a> <a href="/tags/hexo/" style="font-size: 13.33px;">hexo</a> <a href="/tags/iptables/" style="font-size: 10px;">iptables</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/raspberry配置/" style="font-size: 10px;">raspberry配置</a> <a href="/tags/rom/" style="font-size: 10px;">rom</a> <a href="/tags/shadowsocks-vps/" style="font-size: 10px;">shadowsocks/vps</a> <a href="/tags/tool/" style="font-size: 11.11px;">tool</a> <a href="/tags/填坑/" style="font-size: 13.33px;">填坑</a> <a href="/tags/排序算法/" style="font-size: 11.11px;">排序算法</a> <a href="/tags/数据结构/" style="font-size: 10px;">数据结构</a> <a href="/tags/查找算法/" style="font-size: 11.11px;">查找算法</a> <a href="/tags/树莓派raspberry/" style="font-size: 11.11px;">树莓派raspberry</a> <a href="/tags/算法/" style="font-size: 12.22px;">算法</a> <a href="/tags/设计模式/" style="font-size: 17.78px;">设计模式</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">July 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">June 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/04/">April 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/02/">February 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/01/">January 2015</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/03/">March 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/02/">February 2014</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/06/">June 2013</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/01/29/cjnds-asymmetric-cryptography/">握手过程中，非对称密钥的应用</a>
          </li>
        
          <li>
            <a href="/2017/12/04/how-to-fix-rebase-still-in-progress/">如何解决报错“prior sync failed; rebase still in progress”</a>
          </li>
        
          <li>
            <a href="/2017/11/22/cjdns-3steps-lladdrsession/">使用SocketAddress来维护的EndpointsBySockaddr map机制中EndpointsBySockaddr session的建立过程</a>
          </li>
        
          <li>
            <a href="/2017/09/05/cjdns-cryptoauth/">cjdns源码分析--CryptoAuth</a>
          </li>
        
          <li>
            <a href="/2017/09/04/how-to-read-staff/">如何看懂五线谱</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Chris King<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>